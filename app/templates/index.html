{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="container">
    <!-- Notifications Section -->
    <div class="card mb-4 notification-card">
        <div class="card-header bg-pink text-white">
            <h5 class="mb-0">
                <i class="fas fa-bullhorn me-2"></i>Announcements
            </h5>
        </div>
        <div class="card-body">
            {% if notifications %}
                {% for notification in notifications %}
                    <div class="notification-item mb-2">
                        <p class="mb-1">{{ notification.message|safe }}</p>
                        <small class="text-muted">Posted {{ notification.created_at.strftime('%B %d, %Y') }}</small>
                    </div>
                    {% if not loop.last %}
                        <hr class="my-3">
                    {% endif %}
                {% endfor %}
            {% else %}
                <div class="text-center text-muted">
                    <i class="fas fa-comment-slash fa-2x mb-2"></i>
                    <p>No notifications at the moment. Check back soon for updates!</p>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Hero Section -->
    <div class="text-center mb-5">
        <p class="lead">Learn about the UN Sustainable Development Goals (UNSDG) and organize events that support the UNSDG!</p>
        <div class="embed-responsive embed-responsive-16by9 mb-4">
            <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/0XTBYMfZyrM" allowfullscreen></iframe>
        </div>
        <a href="{{ url_for('main.create_event') }}" class="btn btn-primary">Create an Event</a>
    </div>

    <!-- Bingo Game Section (Collapsible) -->
    <div class="accordion mb-5" id="bingoAccordion">
        <div class="accordion-item">
            <h2 class="accordion-header" id="bingoHeader">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#bingoCollapse" aria-expanded="false" aria-controls="bingoCollapse">
                    <i class="fas fa-gift me-2"></i>Win Prizes with SDG Bingo!
                </button>
            </h2>
            <div id="bingoCollapse" class="accordion-collapse collapse" aria-labelledby="bingoHeader">
                <div class="accordion-body">
                    <!-- Top Row with How to Play and Win Prizes -->
                    <div class="row mb-4">
                        <!-- How to Play Column -->
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h4 class="mb-3">How to Play:</h4>
                                    <ol class="list-group list-group-numbered mb-4">
                                        <li class="list-group-item">Create a team to get your unique bingo card</li>
                                        <li class="list-group-item">Organize events that align with UN SDG goals</li>
                                        <li class="list-group-item">Numbers on your card are automatically marked when your events match SDG goals</li>
                                    </ol>
                                </div>
                            </div>
                        </div>

                        <!-- Win Patterns Column -->
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h4 class="mb-3">BINGO Win Patterns:</h4>
                                    <ul class="list-group mb-4">
                                        <li class="list-group-item">
                                            <i class="fas fa-arrows-alt-h text-pink me-2"></i>Any horizontal row
                                        </li>
                                        <li class="list-group-item">
                                            <i class="fas fa-arrows-alt-v text-pink me-2"></i>Any vertical column
                                        </li>
                                        <li class="list-group-item">
                                            <i class="fas fa-grip-horizontal text-pink me-2"></i>Full card
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Prize Categories Column (New) -->
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h4 class="mb-3">Prize Categories:</h4>
                                    <ul class="list-group mb-4">
                                        <li class="list-group-item">
                                            <i class="fas fa-gift text-pink me-2"></i>
                                            <strong>Ongoing Prizes:</strong>
                                            <small class="d-block text-muted ms-4">Win prizes for each BINGO pattern completed!</small>
                                        </li>
                                        <li class="list-group-item">
                                            <i class="fas fa-trophy text-pink me-2"></i>
                                            <strong>Grand Prize:</strong>
                                            <small class="d-block text-muted ms-4">Team with most events by <strong>March 31, 2025</strong></small>
                                        </li>
                                        <li class="list-group-item">
                                            <i class="fas fa-star text-pink me-2"></i>
                                            <strong>Ultimate Challenge:</strong>
                                            <small class="d-block text-muted ms-4">Complete all SDG Goals Progress</small>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bottom Row with Sample Bingo Card -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="mb-3 text-center fs-5">Win Prizes with SDG Bingo:</h4>
                                    <div class="bingo-grid sample-card mx-auto">
                                        <!-- 4x4 grid will be populated by JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sponsors Section (Always Visible) -->
    <div class="card sponsors-card">
        <div class="card-body">
            <h2 class="text-center theme-pink mb-4">
                <i class="fas fa-handshake me-2"></i>Our Sponsors
            </h2>
            <div class="row justify-content-center align-items-center g-4">
                <div class="col-6 col-md-3 text-center">
                    <img src="https://placehold.co/200x100/ff69b4/ffffff?text=EcoTech" alt="EcoTech" class="img-fluid sponsor-logo">
                </div>
                <div class="col-6 col-md-3 text-center">
                    <img src="https://placehold.co/200x100/4CAF50/ffffff?text=SolarFlow" alt="SolarFlow" class="img-fluid sponsor-logo">
                </div>
                <div class="col-6 col-md-3 text-center">
                    <img src="https://placehold.co/200x100/2196F3/ffffff?text=GreenLife" alt="GreenLife" class="img-fluid sponsor-logo">
                </div>
                <div class="col-6 col-md-3 text-center">
                    <img src="https://placehold.co/200x100/9C27B0/ffffff?text=EcoCircle" alt="EcoCircle" class="img-fluid sponsor-logo">
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Generate array of numbers 1-17
    const numbers = Array.from({length: 17}, (_, i) => i + 1);
    
    // Shuffle array using Fisher-Yates algorithm
    for (let i = numbers.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [numbers[i], numbers[j]] = [numbers[j], numbers[i]];
    }
    
    // Take first 16 numbers for 4x4 grid
    const selectedNumbers = numbers.slice(0, 16);
    
    // Get the bingo grid container
    const bingoGrid = document.querySelector('.sample-card');
    
    // Create 4x4 grid
    for (let i = 0; i < 4; i++) {
        const row = document.createElement('div');
        row.className = 'bingo-row';
        
        for (let j = 0; j < 4; j++) {
            const cell = document.createElement('div');
            cell.className = 'bingo-cell';
            // Randomly mark some cells (optional)
            if (Math.random() < 0.2) {
                cell.classList.add('marked');
            }
            cell.textContent = selectedNumbers[i * 4 + j];
            row.appendChild(cell);
        }
        
        bingoGrid.appendChild(row);
    }
});
</script>
{% endblock %}
